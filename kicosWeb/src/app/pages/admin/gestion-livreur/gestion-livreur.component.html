<p-tabView>
  <p-tabPanel header="Listes livreurs">
    <!-- Contenu livreurs -->
    <div class="card border-0 p-4">
      <!-- Titre, recherche et ajout  -->
      <div class="d-flex justify-content-between mb-3">
        <h5 class="fw-bold">Liste des livreurs |</h5>
        <div class="search-and d-flex justify-content-between">
          <!-- Input de recherche  -->
          <div class="me-3">
            <div class="input-group">
              <span class="input-group-text border inputSearch" id="inputGroup-sizing-sm"
                style="background-color: transparent;">
                <i class="pi pi-search"></i>
              </span>
              <input type="search" class="inputSearch form-control" aria-label="Sizing example input"
                aria-describedby="inputGroup-sizing-sm" placeholder="Rechercher">
            </div>
          </div>
          <button class="btn btnValidate" (click)="showDialogAddLivreur()"> <i class="pi pi-plus me-2"></i>
            Ajouter</button>
        </div>
      </div>

      <!-- Liste des livreurs  -->
      @if (tabLivreur.length) {
      <p-table [value]="tabLivreur" [paginator]="true" [rows]="3" [tableStyle]="{ 'min-width': '50rem'}"
        [styleClass]="'paginationTacheCustom'" [rowsPerPageOptions]="[3, 5, 10, 15]">
        <ng-template pTemplate="header">
          <tr class="text-center py-2">
            <th class="">#</th>
            <th class="">Photo </th>
            <th class="">Nom Complet </th>
            <th class="">Téléphone</th>
            <th class="">Adresse</th>
            <th class="">Etat</th>
            <th class="">Action</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-livreur let-index="rowIndex" class="">
          <tr class="py-4">
            <td class="text-center text-xs px-3 tdimg" style="width: 10%;">{{index + 1}}</td>
            <td class="text-center text-xs px-3" style="width: 20%;"><img [src]="livreur.photo" alt=""
                style="width: 50px;"></td>
            <td class="text-center text-xs px-3" style="width: 20%;">{{ livreur.nomComplet}}</td>
            <td class="text-center text-xs" style="width: 15%;">{{ livreur.telephone}}</td>
            <td class="text-center text-xs" style="width: 15%;">{{ livreur.adresse}}</td>
            <td class="text-center text-xs" style="width: 20%;">{{ livreur.etat}}</td>
            <td class="actions-cell">
              <div class="speed-dial" [class.speed-dial--active]="openMenuId === livreur.id">
                <button class="speed-dial__button" (click)="toggleMenu($event, livreur.id)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                  </svg>
                </button>
                <div class="speed-dial__items" *ngIf="openMenuId === livreur.id">
                  <button (click)="onAction('view', livreur.id)" aria-label="Voir détails">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24"
                      stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                  </button>
                  <button (click)="onAction('edit', livreur.id)" aria-label="Éditer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24"
                      stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                  </button>
                  <button (click)="onAction('delete', livreur.id)" aria-label="Supprimer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24"
                      stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                  </button>
                </div>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
      }
      @else {
      <p class="text-center fs-5 fw-bold">Aucun livreur enregistré pour le moment </p>
      }

    </div>

  </p-tabPanel>
  <p-tabPanel header="Performances">
    <!-- Diagramme nombre de livraison par mois -->
    <div class="card border-0 shadow p-3">
      <div class="d-flex mb-5 border-bottom p-3 justify-content-end">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Jour</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Semaine</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Mois</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" style="color: var(--bg-primary);">Année</a>
          </li>
        </ul>
        <div class="border p-2 rounded ">
          <input type="date" class="border-0 me-2 ">
          <input type="date" class="border-0">
        </div>
      </div>

      <p-chart type="bar" [data]="dataLivraison" [options]="optionsLivraison" />
    </div>

    <div class="row m-0 p-0 g-3 mt-5 rowCard1">
      <div class="col-md-7 col-sm-12 content">
        <div class="card border-0 shadow p-3">
          <div class="header border-bottom py-2">
            <h2>Porcentage de livraison par commerce</h2>
            <select class="month-selector ">
              <option *ngFor="let livreur of livreurs" value="{{ livreur.id }}">{{ livreur.name }}</option>
            </select>
          </div>
          <div class="charts-container">
            <div *ngFor="let data of chartDataLivreur" class="chart">
              <p-chart type="doughnut" [data]="data" [options]="chartOptionsCategorie"></p-chart>
              <div class="center-text">{{ data.datasets[0].data[0] }}%</div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-12 content spaceImage">
        <img
          src="https://img.freepik.com/vecteurs-premium/service-livraison-ligne-sans-contact-au-bureau-domicile-moto-suivi-commande-ligne_195968-30.jpg"
          alt="">
      </div>
    </div>
  </p-tabPanel>
</p-tabView>


<!-- Modal ajout livraison -->
<p-dialog [modal]="true" [(visible)]="visibleAddLivreur"
  [style]="{ width: '60rem', height:'50rem', backgroundColor: '#F8F9FD'}" header="Ajout Livreur">
  <form>
    <div class="contentInput">
      <div class="">
        <!-- Nom -->
        <div class="mb-2">
          <label class="mb-1" for="name">Nom </label>
          <input id="name" type="text" class="input-field">
        </div>

        <!-- Téléphone -->
        <div class="mb-2">
          <label for="phone_number" class="mb-1">Téléphone</label>
          <input type="tel" class="input-field" id="telephone">
        </div>

        <!-- Numéro licence -->
        <div class="mb-2">
          <label for="licence" class="mb-1">Numéro licence</label>
          <input type="text" class="input-field" id="licence">
        </div>

        <!-- Password -->
        <div class="form-group mb-2 inputP">
          <label for="password" class="textLabel">Mot de passe</label>
          <input [type]="showPassword ? 'text' : 'password'" class="input-field" id="password">
          <button type="button" (click)="togglePassword()" class="iconEye">
            <i [ngClass]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
          </button>
        </div>

      </div>

      <div class="">
        <!-- Email -->
        <div class="mb-2">
          <label for="email" class="mb-1">Email</label>
          <input type="text" class="input-field" id="email">
        </div>


        <!-- Adresse  -->
        <div class="mb-2">
          <label for="adresse" class="mb-1">Adresse</label>
          <input type="email" class="input-field" id="adresse">
        </div>

        <!-- description -->
        <div class="mb-2">
          <label for="description" class="mb-1">Description</label>
          <input id="description" type="text" class="input-field">
        </div>

        <!-- Password -->
        <div class="form-group mb-2 inputP">
          <label for="password" class="textLabel">Confirmer mot de passe</label>
          <input [type]="showPassword ? 'text' : 'password'" class="input-field" id="password">
          <button type="button" (click)="togglePassword()" class="iconEye">
            <i [ngClass]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
          </button>
        </div>

      </div>
    </div>
    <!-- Photo livreur-->
    <div class="mb-3 ">
      <label for="photoLivreur" class="mb-1">Photo</label>
      <input accept="image/*" name="photo_Livreur" class=" form-control w-full py-1 inputPhoto" id="photoLivreur"
        type="file">
    </div>
    <div class="d-flex justify-content-center">
      <button type="button" class="btn btnAnnuler me-2" (click)="closeModal()">Annuler</button>
      <button type="submit" class="btn btnSave">Enregistrer</button>
    </div>
  </form>
</p-dialog>